<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Matthew Internet Radio - Play</title>
    <link rel="stylesheet" href="/global/styles.css" />
    <link rel="stylesheet" href="/style.css" />
    <link rel="stylesheet" href="/play/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link rel="icon" href="https://cdn.glitch.global/f81e375a-f3b2-430f-9115-3f352b74f21b/MIR Logo.png?v=1716468410227" />
    <script src="/play/script.js" defer></script>
    <style>
      /* Strong, page-scoped overrides to make the Now Playing bar compact and highly visible */
      .now-playing-section{padding:6px 8px !important;}
      .now-playing-card{padding:6px !important;border-radius:6px !important;}
      .now-playing-compact{display:flex;flex-direction:column;gap:6px;align-items:stretch;}
      .now-playing-compact .top-row{display:flex;justify-content:space-between;align-items:center;gap:8px;
    flex-direction: row-reverse;}
      .now-playing-compact .title-wrap{display:flex;gap:6px;align-items:center;min-width:0}
      .now-playing-compact #trackName{font-size:0.95rem;font-weight:600;color:var(--md-sys-color-on-background);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
      .now-playing-compact #trackAuthor{font-size:0.78rem;color:var(--md-sys-color-on-background-variant);opacity:0.9;margin-left:6px}
      .now-playing-compact #trackArtwork{width:40px;height:40px;border-radius:6px;object-fit:cover}
      .now-playing-compact .bottom-row{display:flex;align-items:center;gap:8px;flex-direction: row-reverse;}
      .now-playing-compact .time-left,.now-playing-compact .time-right{width:48px;text-align:center;font-size:0.78rem;color:var(--md-sys-color-on-background-variant)}
      .now-playing-compact .progress-wrap{flex:1}
      .now-playing-compact progress#trackProgressMeter{width:100%;height:6px;border-radius:999px;background:var(--bg-tertiary)!important}
      .now-playing-compact .controls{display:flex;gap:6px;align-items:center;margin-left:8px}
      /* make sure it sits above page content */
      .now-playing-section{z-index:120 !important}
    </style>
  </head>
  <body>
    <nav id="navBar" aria-label="Main navigation">
      <div id="logoBar">
        <div id="logomarkContainer">
          <img
            id="logomark"
            src="https://cdn.glitch.global/f81e375a-f3b2-430f-9115-3f352b74f21b/MIR Logo.png?v=1716468410227"
            alt="Matthew Radio Logo"
          />
        </div>
        <div id="brandWordMark">Matthew Radio</div>
      </div>

      <button id="navToggle" aria-label="Toggle menu" aria-expanded="false" aria-controls="navBarOptions" class="nav-toggle">
        <span class="material-symbols-rounded">menu</span>
      </button>

      <div id="navBarOptions" role="menubar">
        <a href="/" class="navBarOption nav-link" role="menuitem"><span class="material-symbols-rounded">home</span><span class="optionText">Home</span></a>
        <a href="/play" class="navBarOption nav-link" role="menuitem"><span class="material-symbols-rounded">play_arrow</span><span class="optionText">Play</span></a>
        <a href="/join" class="navBarOption nav-link" role="menuitem"><span class="material-symbols-rounded">emoji_people</span><span class="optionText">Join</span></a>
        <a href="/admin" class="navBarOption nav-link" role="menuitem"><span class="material-symbols-rounded">admin_panel_settings</span><span class="optionText">Admin</span></a>
        <a href="/donate" class="navBarOption nav-link" role="menuitem"><span class="material-symbols-rounded">volunteer_activism</span><span class="optionText">Donate</span></a>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="play-container">
      <div class="play-header">
        <h1 class="play-title">Live Radio Streams</h1>
        <p class="play-subtitle">Choose your favorite station and start listening</p>
      </div>

      <div class="stations-section">
        <h2>Available Stations</h2>
        <div id="substationList" class="stations-grid"></div>
      </div>

      <div id="nowPlayingUI" class="now-playing-section">
        <div class="now-playing-card now-playing-compact">
          <div class="top-row">
            <div class="title-wrap">
              <span id="trackName">Select a station to start listening</span>
              <span id="trackAuthor">by Nobody</span>
            </div>
            <img id="trackArtwork" src="https://cdn.glitch.global/f81e375a-f3b2-430f-9115-3f352b74f21b/WR%20Substation%20Icon.png?v=1716472186074" alt="art" />
          </div>

          <div class="bottom-row">
            <div class="time-left"><span id="trackCurrentPosition">0:00</span></div>
            <div class="progress-wrap"><progress id="trackProgressMeter" value="0" max="100"></progress></div>
            <div class="time-right"><span id="trackDuration">0:00</span></div>
            <div class="controls">
              <button id="playPauseBtn" class="control-btn" disabled><span class="material-symbols-rounded">play_arrow</span></button>
              <button id="stopBtn" class="control-btn" disabled><span class="material-symbols-rounded">stop</span></button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <audio id="audio" src=""></audio>

    <script>
      // Mobile nav toggle (copied from root for consistent behavior)
      (function(){
        const toggle = document.getElementById('navToggle');
        const menu = document.getElementById('navBarOptions');
        if (!toggle || !menu) return;
        toggle.addEventListener('click', () => {
          const open = menu.classList.toggle('open');
          toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
        });
        // Close menu when clicking outside on small screens
        document.addEventListener('click', (e) => {
          if (!menu.classList.contains('open')) return;
          if (e.target.closest('#navBar')) return;
          menu.classList.remove('open');
          toggle.setAttribute('aria-expanded', 'false');
        });
      })();
    </script>

    <footer id="copyrightText">
      <p>Copyright Matthew Internet Radio. All rights reserved.</p>
    </footer>
  </body>
</html>
